@startuml UmrahTravelAgent_FullCorrected

'==================== CORE ENTITIES ====================

class Pilgrim {
  +id: int
  +nomFrancais: String
  +nomArabe: String
  +prenomArabe: String
  +dateNaissance: Date
  +ville: String
  +tel_1: String
  +tel_2: String
  +typeDiabete: String
  +commentaire: String
}

class PassportInfo {
  +id: int
  +pilgrimId: int
  +numeroPasseport: String
  +dateDelivrance: Date
  +dateExpiration: Date
}

class Agent {
  +id: int
  +nom: String
  +telephone: String
}

class Event {
  +id: int
  +code: String          
  +departDate: Date
  +returnDate: Date
  +departCity: String
  +destinations: String
  +description: String
}

class Package {
  +id: int
  +typePack: String       // Gold, Standard, VIP...
  +category: String       // Adult, Child...
  +programme: String
  +agentId: int
  +eventId: int
}

class Hotel {
  +id: int
  +nom: String
  +ville: String
  +distanceMasjid: int
}

class Room {
  +id: int
  +hotelId: int
  +type: String         // Single, Double, Triple, Quad
  +capacity: int
  +pricePerNight: Decimal
}

class Reservation {
  +id: int
  +pilgrimId: int
  +packageId: int
  +roomId: int
  +totalPrix: Decimal
  +montantPaye: Decimal
  +selectionne: Boolean
}

class Alert {
  +id: int
  +pilgrimId: int
  +type: String
  +message: String
}

class Transport {
  +id: int
  +packageId: int        // direct FK to Package
  +type: String          // Flight, Bus, Train
  +provider: String
  +departCity: String
  +arriveCity: String
  +departDate: Date
  +arriveDate: Date
  +status: String        // Confirmed, Pending, Cancelled
  +reference: String     // flight number, bus ref...
}

class Relationship {
  +id: int
  +pilgrimAId: int
  +pilgrimBId: int
  +relationType: String   // Husband, Wife, Father, Mother...
}

'==================== RELATIONSHIPS ====================

Pilgrim "1" -- "0..*" PassportInfo : has >
Pilgrim "1" -- "0..*" Reservation : books >
Pilgrim "1" -- "0..*" Alert : triggers >

' Relationship properly linked
Pilgrim "1" -- "0..*" Relationship : defines >
Relationship "1" -- "1" Pilgrim : relates to >

Agent "1" -- "0..*" Package : manages >
Event "1" -- "0..*" Package : includes >

Hotel "1" -- "0..*" Room : offers >
Room "1" -- "0..*" Reservation : used in >
Package "1" -- "0..*" Reservation : referenced by >

Package "1" -- "0..*" Transport : includes >

@enduml