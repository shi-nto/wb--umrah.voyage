@startuml UmrahTravelAgent_FullyCorrected

'==================== CORE ENTITIES ====================

class Pilgrim {
  +id: int
  +nomFrancais: String
  +nomArabe: String
  +prenomArabe: String
  +dateNaissance: Date
  +ville: String
  +tel_1: String
  +tel_2: String
  +typeDiabete: String
  +commentaire: String
}

class PassportInfo {
  +id: int
  +pilgrimId: int
  +numeroPasseport: String
  +dateDelivrance: Date
  +dateExpiration: Date
}

class Agent {
  +id: int
  +nom: String
  +telephone: String
}

class Event {
  +id: int
  +code: String          
  +departDate: Date
  +returnDate: Date
  +departCity: String
  +destinations: String
  +description: String
}

class Package {
  +id: int
  +typePack: String      
  +category: String      
  +programme: String
  +agentId: int
  +eventId: int
}

class Hotel {
  +id: int
  +nom: String
  +ville: String
  +distanceMasjid: int
}

class Room {
  +id: int
  +hotelId: int
  +type: String        
  +capacity: int
  +pricePerNight: Decimal
}

class Reservation {
  +id: int
  +pilgrimId: int
  +packageId: int
  +roomId: int
  +totalPrix: Decimal
  +montantPaye: Decimal
  +selectionne: Boolean
}

class Alert {
  +id: int
  +pilgrimId: int
  +type: String
  +message: String
}

class Transport {
  +id: int
  +type: String          
  +provider: String
  +departCity: String
  +arriveCity: String
  +departDate: Date
  +arriveDate: Date
  +status: String        
  +reference: String     
  +price: Decimal        // Added Transport Price
}

class PackageTransport {
  +id: int
  +packageId: int
  +transportId: int
  +direction: String     
  +segmentOrder: int
}

class Relationship {
  +id: int
  +pilgrimAId: int
  +pilgrimBId: int
  +relationType: String  
}

class PackageHotel {
  +id: int
  +packageId: int
  +hotelId: int
  +city: String         
  +nights: int
}

'==================== RELATIONSHIPS ====================

Pilgrim "1" -- "1" PassportInfo : has >
Pilgrim "1" -- "0..*" Reservation : books >
Pilgrim "1" -- "0..*" Alert : triggers >

Pilgrim "1" -- "0..*" Relationship : is A >
Pilgrim "1" -- "0..*" Relationship : is B >

Agent "1" -- "0..*" Package : manages >
Event "1" -- "0..*" Package : includes >

Package "1" -- "0..*" PackageHotel : includes >
PackageHotel "1" -- "1" Hotel : uses >

Hotel "1" -- "0..*" Room : offers >
Room "1" -- "0..*" Reservation : usedFor >

Package "1" -- "0..*" Reservation : referenced >

Package "1" -- "0..*" PackageTransport : uses >
Transport "1" -- "0..*" PackageTransport : assignedTo >

@enduml
